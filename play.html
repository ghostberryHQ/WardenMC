<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="styles_play.css">
    <link rel="stylesheet" href="circles_play.css">
    <script src="main.js"></script>
    <meta charset="UTF-8">
    <title>Warden</title>
  </head>
  <body>
    <div class="area" >
        <ul class="circles">
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ul>
    </div >
        <script>

          const { ipcRenderer } = require('electron');

          /* Kristuff.WebUI.SideMenu */
(function (window, undefined) {
    'use strict';
    // responsive pinnable sidemenu component
    var sideMenu = function (el) {
        var htmlSideMenu = el, htmlSideMenuPinTrigger = {}, htmlSideMenuPinTriggerImage = {}, htmlOverlay = {};
        var init = function () {
            htmlSideMenuPinTrigger = el.querySelector('.wui-side-menu-pin-trigger');
            htmlOverlay = document.querySelector('.wui-overlay');
            Array.prototype.forEach.call(document.querySelectorAll('.wui-side-menu-trigger'), function (elmt, i) {
                elmt.addEventListener('click', function (e) {
                    e.preventDefault();
                    toggleMenuState();
                }, false);
            });
            htmlOverlay.addEventListener("click", function (e) {
                htmlSideMenu.classList.remove('open');
            }, false);
            window.addEventListener("resize", checkIfNeedToCloseMenu, false);
            checkIfNeedToCloseMenu();
        };
        var toggleMenuState = function () {
            htmlSideMenu.classList.toggle('open');
            menuStateChanged(htmlSideMenu, htmlSideMenu.classList.contains('open'));
        };
        var toggleMenuPinState = function () {
            htmlSideMenu.classList.toggle('pinned');
            htmlSideMenuPinTriggerImage.classList.toggle('fa-rotate-90');
            if (htmlSideMenu.classList.contains('pinned') !== true) {
                htmlSideMenu.classList.remove('open');
            }
            menuPinStateChanged(htmlSideMenu, htmlSideMenu.classList.contains('pinned'));
        };
        var checkIfNeedToCloseMenu = function () {
            var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
            if (width <= 767 && htmlSideMenu.classList.contains('open') === true) {
                htmlSideMenu.classList.remove('open');
                menuStateChanged(htmlSideMenu, htmlSideMenu.classList.contains('open'));
            }
            if (width > 767 && htmlSideMenu.classList.contains('pinned') === false) {
                htmlSideMenu.classList.remove('open');
                menuStateChanged(htmlSideMenu, htmlSideMenu.classList.contains('open'));
            }
        };
        var menuStateChanged = function (element, state) {
            var evt = new CustomEvent('menuStateChanged', { detail: { open: state} });
            element.dispatchEvent(evt);
        };
        var menuPinStateChanged = function (element, state) {
            var evt = new CustomEvent('menuPinStateChanged', { detail: { pinned: state} });
            element.dispatchEvent(evt);
        };
        init();
        return {
            htmlElement: htmlSideMenu,
            toggleMenuState: toggleMenuState,
            toggleMenuPinState: toggleMenuPinState
        };
    };
    
    window.SideMenu = sideMenu;
})(window);


var documentReady = function (fn) {
  if (document.readyState != 'loading') {
    fn();
  } else {
    document.addEventListener('DOMContentLoaded', fn);
  }
};

documentReady(function() {
  var sample = new SideMenu(document.querySelector('.wui-side-menu'))
  sample.htmlElement.addEventListener('menuPinStateChanged', function(e) {
    document.querySelector('#events').innerHTML += 'menuPinStateChanged , menu pinned? => ' 
      + e.detail.pinned + '<br>'; 
  }, false);
  sample.htmlElement.addEventListener('menuStateChanged', function(e) {
    document.querySelector('#events').innerHTML += 'menuStateChanged , menu open? => ' 
      + e.detail.open + '<br>'; 
  }, false);
});

function showToast(text){
        var isShowing = false;
        var x=document.getElementById("toast");
        if(isShowing == false) {
          x.classList.add("show");
          var isShowing = true;
          x.innerHTML=text;
          setTimeout(function(){
            x.classList.remove("show");
            var isShowing = false;
        },3000);
        }
      }

    function loadGame() {
      var mcVersion = document.getElementById("versionSelectID").value
      ipcRenderer.send('startGame', { data: mcVersion });
      var e = document.getElementById("ddlViewBy");
      var strUser = e.options[e.selectedIndex].text;
    }
</script>

<div class="wui-side-menu open pinned" data-wui-theme="dark">    
  <ul class="wui-side-menu-items">
    <li>
      <a href="#" class="wui-side-menu-item active">
        <b><span class="box-title">Play</span></b>
      </a>
    </li>
    <li>
      <a href="#" class="wui-side-menu-item" onclick="showToast('Coming Soon!');">
        <b><span class="box-title">Friends</span></b>
      </a>
    </li>
    <li>
      <a href="#" class="wui-side-menu-item" onclick="showToast('Coming Soon!');">
        <b><span class="box-title">Accounts</span></b>
      </a>
    </li>
    <li>
      <a href="#" class="wui-side-menu-item" onclick="showToast('Coming Soon!');">
        <b><span class="box-title">Settings</span></b>
      </a>
    </li>
    <li>
      <a href="#" class="wui-side-menu-item" style="bottom:0; position:absolute;" onclick="signOut();">
        <b><span class="box-title">Sign Out</span></b>
      </a>
    </li>
  </ul>
</div>
<div class="wui-content">
  <div class="wui-content-header">
    <a href="#" class="wui-side-menu-trigger"><i class="fa fa-bars"></i></a>
  </div> 
  <div class="wui-content-main">
    <center>
      <h1>Warden</h1>
      <h2>A simple and modern Minecraft client.</h2>
      <h3 id="signedin" style="display: inline-block;">Signed in as</h3>
      <img id="avatar" src="https://crafatar.com/avatars/" alt="AVATAR" width="25" height="25" style="position: relative; top: 5px;" onerror="if (this.src != 'https://crafatar.com/avatars/853c80ef3c3749fdaa49938b674adae6') this.src = 'https://crafatar.com/avatars/853c80ef3c3749fdaa49938b674adae6';">
      <!-- <progress id="file" max="100"> 32% </progress> -->
      <div class="select" style="width: 200px;">
        <select id="versionSelectID">
          <option>1.18.2</option>
          <option>1.8.9</option>
        </select>
        <fieldset>
          <legend>Version</legend>
        </fieldset>
        <svg viewBox="0 0 24 24">
          <path xmlns="http://www.w3.org/2000/svg" d="M10 12.458Q9.833 12.458 9.677 12.396Q9.521 12.333 9.375 12.188L5.604 8.417Q5.354 8.167 5.375 7.792Q5.396 7.417 5.625 7.188Q5.896 6.917 6.25 6.927Q6.604 6.938 6.854 7.188L10 10.354L13.167 7.188Q13.417 6.938 13.76 6.938Q14.104 6.938 14.375 7.208Q14.625 7.458 14.625 7.823Q14.625 8.188 14.375 8.438L10.625 12.188Q10.479 12.333 10.323 12.396Q10.167 12.458 10 12.458Z"/>
        </svg>
      </div>
      <div class="button" onclick="loadGame(); showToast('Launching Minecraft. Please wait.');"><b>PLAY</b></div>
    </center>
    <div id="events"></div>
    <div id="toast"></div>
  </div>
</div>
  </div>


  <script>
    const authJSON = fs.readFileSync(process.env.APPDATA + "/warden/auth/auth.json");
    const parsedAuthJSON = JSON.parse(authJSON);
    var signedin = document.getElementById("signedin");
    signedin.innerHTML = "Signed in as: " + parsedAuthJSON.name;
    document.getElementById("avatar").src = "https://crafatar.com/avatars/" + parsedAuthJSON.uuid;
  </script>
</html>